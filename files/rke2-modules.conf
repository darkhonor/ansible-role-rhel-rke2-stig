###############################################################################
# Filename: /etc/modules-load.d/rke2-modules.conf
# Role: ansible-role-rhel-rke2-stig
# Summary: Kernel modules required for RKE2 Kubernetes networking. Includes
#   bridge/netfilter, IPVS (kube-proxy), iptables, NAT, and overlay networking
#   modules.
# Last Updated: 23 Jan 2026
# Classification: UNCLASSIFIED
#
# Note: Some modules (nf_conntrack_ipv4, nf_nat_ipv4, nf_defrag_ipv4) were
#   removed as they are deprecated/merged in RHEL 9+ kernels.
###############################################################################

# Bridge and netfilter (required for CNI networking)
br_netfilter
bridge

# IPVS modules (for kube-proxy IPVS mode)
ip_vs
ip_vs_rr
ip_vs_sh
ip_vs_wrr

# IP sets (used by Calico and other CNIs)
ip_set
ip_set_hash_ip
ip_set_hash_net

# Connection tracking
nf_conntrack
nf_conntrack_netlink

# NAT (Network Address Translation)
nf_nat

# iptables modules (legacy compatibility)
iptable_filter
iptable_nat
iptable_mangle
iptable_raw

# Netfilter extensions
x_tables
xt_addrtype
xt_conntrack
xt_comment
xt_connmark
xt_mark
xt_multiport
xt_nat
xt_owner
xt_recent
xt_REDIRECT
xt_set
xt_statistic
xt_tcpudp

# Tunneling and overlay networking
ip6_udp_tunnel
udp_tunnel
vxlan

# Virtual ethernet (container networking)
veth
